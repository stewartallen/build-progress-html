# CLAUDE.md - RV-10 Build Progress Tracker - static HTML progress page

## Project Overview

A static HTML status page displaying the current progress of the RV-10 aircraft kit construction project. Features a GitHub-style contribution chart showing daily build hours with color intensity mapping, plus a comprehensive statistics dashboard. Designed for self-hosted deployment on status dashboards, monitors, or mobile devices.

**Status: Production Ready** âœ…

This project is complete and ready for deployment. All core features have been implemented and tested.

## Project Goals

âœ… **All Goals Achieved:**

- âœ… Load JSON file generated by `build-progress-cli` and display build progress
- âœ… Chart grouped by year (newest first)
- âœ… Statistics section with clear, organized labels
- âœ… Professional dashboard design following UI best practices
- âœ… Color intensity (green/grey) showing hours worked per day
- âœ… Interactive tooltips on hover showing date and exact hours
- âœ… Mobile-responsive for all device sizes
- âœ… Auto-refresh for long-running displays

## Technology Stack

- **Data Source**: `build-progress-cli` (found in `../build-progress-cli`) generates `progress.json`
- **HTML/CSS/JS**: Vanilla JavaScript, self-contained single HTML file
- **Chart Library**: Cal-Heatmap v4.2.4 (via CDN) - Purpose-built calendar heatmap library
    - D3.js v7 (loaded from d3js.org CDN as required dependency)
    - @popperjs/core v2 (for tooltip positioning)
    - Plugins: Tooltip, CalendarLabel
    - GitHub-style contribution graph layout
    - UMD bundle format (loaded via script tags)
- **CSS**: Custom CSS with dark theme (GitHub-inspired)
- **Build System**: None required - single HTML file with embedded CSS/JS and CDN dependencies
- **Deployment**: Any static web server (nginx, Apache, Python SimpleHTTPServer, etc.)

## Data Structure

The `progress.json` file generated by `build-progress-cli` has the following structure:

```json
{
  "log": [
    { "date": "2022-02-02", "hours": 4.4 },
    { "date": "2022-02-03", "hours": 0.0 },
    ...
  ],
  "statistics": {
    "total_hours": 1528.4,
    "days_worked": 473,
    "avg_hours_per_week": 7.9,
    "avg_hours_last_6_weeks": 3.4,
    "est_completion_date": "2028-02-21",
    "est_completion_date_6_weeks": "2031-04-07",
    "hours_current_week": 0.0,
    "hours_current_month": 7.0,
    "hours_last_30_days": 14.8,
    "current_streak": 0,
    "record_streak": {
      "days": 9,
      "start_date": "2023-06-30"
    }
  }
}
```

## Implementation Details

### File Structure

- `index.html` - Single self-contained HTML file with embedded CSS and JavaScript
- `progress.json` - Data file loaded via fetch API

### Color Scale

5-level color intensity mapping hours worked per day (GitHub-style colors):

- Level 0: Dark Grey (#30363d) - 0 hours
- Level 1: Dark Green (#0e4429) - 0.1 to <2 hours
- Level 2: Medium Green (#006d32) - 2 to <4 hours
- Level 3: Bright Green (#26a641) - 4 to <6 hours
- Level 4: Brightest Green (#39d353) - 6 to <8 hours
- Level 5: Brightest Green (#39d353) - 8+ hours

Thresholds: `[0.1, 2, 4, 6, 8]`

### Chart Layout

- GitHub-style contribution graph using Cal-Heatmap v4 library
- Each year rendered as a separate Cal-Heatmap instance
- Month domain with GitHub day subdomain (`ghDay`) - vertical weeks layout
- Each day is an 18x18px cell with 6px gutter, 2px border radius
- 6px gutter between months
- Month labels displayed at top (MMM format)
- Day labels on left side (Mon, Tue, Wed, Thu, Fri, Sat, Sun - alternating display) via CalendarLabel plugin
- Interactive tooltips showing formatted date and hours on hover via Tooltip plugin
- Years displayed newest first (2025, 2024, 2023, 2022)
- Single legend displayed at top showing "Less ... More" color scale

### Statistics Display

8 card grid showing:

1. **Total Hours**: Total hours worked with percentage of 2,500 hour goal
2. **Days Worked**: Number of days with at least one work session
3. **Average Per Week**: Overall average and last 6 weeks trend
4. **Current Week**: Current week hours plus month and 30-day totals
5. **Est. Completion**: Based on overall average pace
6. **Est. Completion (6-week trend)**: Based on recent pace
7. **Current Streak**: Number of consecutive days worked
8. **Record Streak**: Longest streak with start date

### Interactive Features

- Hover tooltips showing formatted date and exact hours (via Cal-Heatmap Tooltip plugin)
- Day-of-week labels (Mon, Wed, Fri) via CalendarLabel plugin
- Dark theme matching GitHub's dashboard aesthetic
- Responsive grid layout for statistics cards
- Error handling for failed data loads
- Custom legend showing color scale from less to more hours
- Auto-refresh: Data automatically reloads every 15 minutes without page refresh
- Mobile-responsive design with 4 breakpoints (desktop, tablet, phone, small phone)

### Technical Decisions

- **Cal-Heatmap Library v4**: Purpose-built for calendar heatmaps, handles complex layout and interactions
    - Eliminates need for custom grid rendering code
    - Built-in GitHub-style day layout (`ghDay` subdomain type)
    - Extensible via plugins (Tooltip, CalendarLabel)
    - Loaded via UMD bundles from unpkg CDN
- **D3.js Dependency**: Cal-Heatmap requires D3.js for DOM manipulation and transitions
    - Loaded from official d3js.org CDN before Cal-Heatmap
    - Provides necessary transition methods used by Cal-Heatmap
- **Script Tags with UMD Bundles**: Using traditional `<script>` tags rather than ES modules
    - D3.js v7, Cal-Heatmap v4, @popperjs/core, and plugins loaded as global variables
    - Simpler dependency resolution than ES modules for this use case
    - No import maps or module specifiers required
- **Vanilla JavaScript**: Application logic kept simple with standard DOM manipulation
- **Fetch API**: Standard browser API for loading JSON data
- **No build step**: File can be served directly without compilation or bundling
- **Custom Legend**: Using custom HTML/CSS legend displayed once at top for better layout control
- **Mobile-Responsive CSS**: Media queries for 4 breakpoints without JavaScript
    - Desktop (>1024px): Full layout with multi-column grid
    - Tablet (â‰¤1024px): Narrower grid columns (200px minimum)
    - Phone (â‰¤640px): Single column layout, reduced spacing and font sizes
    - Small Phone (â‰¤480px): Further reduced typography
    - Landscape (â‰¤768px): Two-column stats grid for better space utilization
    - Chart containers allow horizontal scrolling on smaller screens

## Current Status

**ðŸŽ‰ Project Complete - Production Ready**

All planned features have been successfully implemented and are ready for deployment.

### Completed Features

**Core Functionality:**
- âœ… Single HTML file with embedded CSS/JS (no build step required)
- âœ… Loads and parses `progress.json` generated by `build-progress-cli`
- âœ… GitHub-style contribution chart using Cal-Heatmap v4 library
- âœ… Year-based grouping (2025, 2024, 2023, 2022 - newest first)
- âœ… 5-level color intensity scale (grey to green based on hours worked)
- âœ… Interactive hover tooltips with formatted dates and hour counts

**Statistics Dashboard:**
- âœ… 8 metric cards displaying comprehensive build statistics:
  1. Total Hours (with % of 2,500 hour goal)
  2. Days Worked
  3. Average Per Week (overall + last 6 weeks trend)
  4. Current Week (+ month + last 30 days)
  5. Estimated Completion (based on overall average)
  6. Estimated Completion (based on 6-week trend)
  7. Current Streak
  8. Record Streak (with start date)

**Design & UX:**
- âœ… Dark theme matching GitHub's dashboard aesthetic
- âœ… Mobile-responsive design with 4 breakpoints
  - Desktop (>1024px), Tablet (â‰¤1024px), Phone (â‰¤640px), Small Phone (â‰¤480px)
- âœ… Landscape orientation optimization
- âœ… Professional color palette and typography
- âœ… Readable on screens as small as 320px wide

**Technical Features:**
- âœ… Auto-refresh every 15 minutes (ideal for dashboard displays)
- âœ… Error handling for failed data loads
- âœ… Horizontal scrolling for charts on narrow screens
- âœ… CDN-based dependencies (D3.js v7, Cal-Heatmap v4, Popper.js)
- âœ… No build process - works immediately when served

**Code Quality:**
- âœ… Prettier formatting configured
- âœ… ESLint linting configured
- âœ… EditorConfig for consistency
- âœ… NPM scripts for development workflow

### Deployment Status

âœ… **Ready for production deployment** on any static web server:
- nginx
- Apache
- Python SimpleHTTPServer
- Node.js static server
- GitHub Pages
- Netlify, Vercel, etc.

Simply serve `index.html` and `progress.json` - no compilation or build step needed.

## Code Quality & Formatting

### Tools

- **Prettier**: Code formatting for HTML, CSS, and JavaScript
- **ESLint**: JavaScript linting (with eslint-plugin-html for embedded scripts)
- **EditorConfig**: Editor consistency across different IDEs

### Configuration Files

- `.prettierrc` - Prettier formatting rules (4-space indentation, single quotes, 100 char line width)
- `.eslintrc.json` - ESLint rules (browser environment, ES2021, lints embedded JS in HTML)
- `.editorconfig` - Editor settings (UTF-8, LF line endings, trim trailing whitespace)
- `.prettierignore` - Files to exclude from formatting (node_modules, progress.json)
- `.eslintignore` - Files to exclude from linting (node_modules, progress.json)

### NPM Scripts

```bash
# Format all files with Prettier
npm run format

# Check formatting without changing files
npm run format:check

# Lint JavaScript (including embedded in HTML)
npm run lint

# Auto-fix linting issues
npm run lint:fix

# Check both formatting and linting
npm run check

# Fix both formatting and linting
npm run fix

# Start local development server
npm run serve
```

### Pre-Commit Workflow

Before committing changes, always run:

```bash
npm run fix
```

This will automatically format and lint all code.

## Usage

### Setup

```bash
# Install development dependencies
npm install
```

### Local Development

```bash
# Start a simple HTTP server
npm run serve
# OR
python3 -m http.server 8000

# Open browser to http://localhost:8000
```

### Deployment

Simply copy `index.html` and `progress.json` to your web server directory. The page will automatically load and display the data.

### Updating Data

Replace `progress.json` with newly generated data from `build-progress-cli`. The page will show updated statistics and charts on next reload.

## Development History

### Implementation Timeline

1. **Initial Implementation** - Custom vanilla JS chart
   - GitHub-style contribution grid built from scratch
   - Custom CSS Grid layout for calendar
   - Manual day/week/month calculations

2. **Code Quality Setup** - Development tooling
   - Added Prettier, ESLint, EditorConfig
   - Configured NPM scripts for formatting/linting
   - Established pre-commit workflow

3. **Chart Enhancements** - Iterative improvements
   - Added month labels (top) and day labels (left side)
   - Fixed tooltip positioning (clientX/clientY)
   - Reversed year order (newest first)
   - Adjusted colors (#30363d for 0-hour days)

4. **Statistics Enhancement** - Added streak tracking
   - Current streak (consecutive days worked)
   - Record streak (longest streak with start date)
   - Updated dashboard to 8 metric cards

5. **Cal-Heatmap Integration** - Library migration
   - Replaced custom JS with Cal-Heatmap v4.2.4
   - Resolved D3.js dependency issues (loaded from d3js.org)
   - Switched from ES modules to UMD bundles
   - Configured GitHub-style subdomain (`ghDay`)
   - Adjusted cell sizes (18x18px with 6px gutters)

6. **Auto-Refresh Feature** - Dashboard optimization
   - Implemented 15-minute auto-reload with setInterval
   - Ideal for long-running dashboard displays

7. **Mobile-Responsive Design** - Cross-device support
   - Added CSS media queries for 4 breakpoints
   - Single-column layout on phones
   - Scaled typography and spacing for mobile
   - Landscape orientation optimization

### Key Technical Decisions

- **Cal-Heatmap over custom implementation**: Better maintenance, established library, built-in features
- **UMD bundles over ES modules**: Simpler D3 dependency resolution for browser use
- **CSS-only responsive design**: No JavaScript required, works universally
- **15-minute refresh interval**: Balances freshness with minimal overhead (data updates daily)
- **CDN dependencies**: No build step, immediate deployment capability

## Future Enhancements

Optional improvements for future consideration:

- [ ] Export chart as static image for ePaper display
- [ ] Configurable color thresholds (currently `[0.1, 2, 4, 6, 8]`)
- [ ] Additional chart views (weekly/monthly aggregation, trends)
- [ ] Configurable refresh interval (currently hardcoded to 15 minutes)
- [ ] Adaptive chart sizing for mobile (JavaScript-based, show 3-6 months per chart on small screens)
- [ ] Touch-optimized interactions (larger touch targets, tap instead of hover)
- [ ] Dark/light theme toggle
- [ ] Print-friendly stylesheet
